<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <title>TransGame</title>
  </head>
<script src="http://gkovacs.xvm.mit.edu/transgame/jquery.min.js"></script>
<script src="http://gkovacs.xvm.mit.edu/transgame/jquery.cookie.js"></script>
<!--<script src="http://gkovacs.xvm.mit.edu/transgame/jquery-ui.min.js"></script>-->
<script src="http://gkovacs.xvm.mit.edu/transgame/jquery.gritter.min.js"></script>
<!--<script src="http://gkovacs.xvm.mit.edu/transgame/jquery.notify.js"></script>-->
<script src="http://gkovacs.xvm.mit.edu/transgame/etherpad.js"></script>
<script src="http://gkovacs.xvm.mit.edu/transgame/base64.js"></script>
<script src="http://gkovacs.xvm.mit.edu/transgame/md5.js"></script>
<script src="http://gkovacs.xvm.mit.edu/transgame/dragresize.js"></script>
<script src="http://gkovacs.xvm.mit.edu:9000/nowjs/now.js"></script>
<script>

userid = $.cookie('transgame_userid');
if (userid == null) {
  alert('warning: no userid, going back to login page');
  window.location = 'http://gkovacs.xvm.mit.edu/transgame/index.html';
  //userid = Math.floor(Math.random()*10000001);
  //$.cookie('transgame_userid', userid, { expires: 7, path: '/' });
}

now.userid = userid

function setGameList(gameToUsers, gameList) {
var curhtml = ''
for (var i = 0; i < gameList.length; ++i) {
var game = gameList[i]
var users = gameToUsers[game]
curhtml += '<a href="http://gkovacs.xvm.mit.edu:8080/?url=' + game + '">' + game + '</a>'
for (var j = 0; j < users.length; ++j) {
curhtml += ' ' + users[j]
}
curhtml += '<br/>'

}
$('#gameListDisplay').html(curhtml)
}

now.sendGameList = setGameList

function gotoPage() {
pageURL = document.forms["frm1"]["urlToTranslate"].value;
if (pageURL.indexOf('http://') != 0)
  pageURL = 'http://' + pageURL;
//alert(pageURL);
window.location = '/?url=' + pageURL;
return false;
}

now.ready(function() {
  now.sendGameListCallback(setGameList);
})

$(document).ready(function(){

$('#welcome').html('Welcome, ' + userid + '. Please pick an existing game to join, or enter a new URL.');

});

</script>
<body>

<div id='welcome'></div>
<form name="frm1" action="" onsubmit="return gotoPage()">
URL to translate: <input type="text" name="urlToTranslate" />
<input type="submit" value="Start New Translation Game" /></form><br/>
<div id='gameListDisplay'></div>

</body>
</html>
